{
  "id": "batch-flux2-klein-workflow",
  "revision": 0,
  "last_node_id": 85,
  "last_link_id": 170,
  "nodes": [
    {
      "id": 9,
      "type": "SaveImage",
      "pos": [730, 341],
      "size": [520, 550],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 154
        },
        {
          "name": "filename_prefix",
          "type": "STRING",
          "link": 168,
          "widget": {"name": "filename_prefix"}
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": ["Flux2-Klein-Batch"]
    },
    {
      "id": 79,
      "type": "MarkdownNote",
      "pos": [-710, 340],
      "size": [550, 630],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "# BATCH IMAGE GENERATION FROM TEXT FILE\n\n---\n\n## üìù How to Use This Workflow\n\n1. **Create a text file** (e.g., `prompts.txt`) with one prompt per line\n2. **Update the file path** in the LoadText node below\n3. **Queue Prompt** - it will automatically generate one image per prompt\n4. Images saved as: `Flux2-Klein-Batch_0001`, `Flux2-Klein-Batch_0002`, etc.\n\n---\n\n## üì¶ Required Custom Nodes\n\nInstall via ComfyUI Manager:\n- **ComfyUI-Custom-Scripts** (for LoadText)\n- **ComfyUI-Logic** (for StringToList and LoopManager)\n\n---\n\n## üü£ Models Required\n\n**diffusion_models:**\n- [flux-2-klein-base-9b-fp8.safetensors](https://huggingface.co/black-forest-labs/FLUX.2-klein-base-9b-fp8)\n\n**text_encoders:**\n- [qwen_3_8b_fp8mixed.safetensors](https://huggingface.co/Comfy-Org/flux2-klein-9B/resolve/main/split_files/text_encoders/qwen_3_8b_fp8mixed.safetensors)\n\n**vae:**\n- [flux2-vae.safetensors](https://huggingface.co/Comfy-Org/flux2-dev/resolve/main/split_files/vae/flux2-vae.safetensors)\n\n---\n\n## üí° Tips\n- Empty lines in your text file will be skipped\n- Each image uses a randomized seed\n- Adjust steps in the subgraph (default: 20 steps)\n"
      ],
      "color": "#222",
      "bgcolor": "#000"
    },
    {
      "id": 80,
      "type": "LoadText",
      "pos": [-140, 1000],
      "size": [400, 200],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [165]
        }
      ],
      "title": "üìÑ Load Prompts from Text File",
      "properties": {
        "Node name for S&R": "LoadText"
      },
      "widgets_values": [
        "prompts.txt",
        ""
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 81,
      "type": "StringToList",
      "pos": [300, 1000],
      "size": [300, 100],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        {
          "name": "text",
          "type": "STRING",
          "link": 165
        }
      ],
      "outputs": [
        {
          "name": "LIST",
          "type": "LIST",
          "links": [166]
        }
      ],
      "title": "Split Prompts by Line",
      "properties": {
        "Node name for S&R": "StringToList"
      },
      "widgets_values": ["\n", "lines"],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 82,
      "type": "LoopManager",
      "pos": [640, 1000],
      "size": [300, 150],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {
          "name": "list",
          "type": "LIST",
          "link": 166
        }
      ],
      "outputs": [
        {
          "name": "ITEM",
          "type": "STRING",
          "links": [167]
        },
        {
          "name": "INDEX",
          "type": "INT",
          "links": [169]
        }
      ],
      "title": "üîÑ Loop Through Prompts",
      "properties": {
        "Node name for S&R": "LoopManager"
      },
      "widgets_values": [0, "restart"],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 84,
      "type": "String Format",
      "pos": [640, 1200],
      "size": [300, 100],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "index",
          "type": "INT",
          "link": 169
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [168]
        }
      ],
      "title": "Create Unique Filename",
      "properties": {
        "Node name for S&R": "String Format"
      },
      "widgets_values": ["Flux2-Klein-Batch_{index:04d}_"],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 75,
      "type": "7b34ab90-36f9-45ba-a665-71d418f0df18",
      "pos": [300, 341],
      "size": [400, 415],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "label": "width",
          "name": "value",
          "type": "INT",
          "widget": {"name": "value"},
          "link": null
        },
        {
          "label": "height",
          "name": "value_1",
          "type": "INT",
          "widget": {"name": "value_1"},
          "link": null
        },
        {
          "label": "prompt",
          "name": "text",
          "type": "STRING",
          "widget": {"name": "text"},
          "link": 167
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [154]
        }
      ],
      "properties": {
        "proxyWidgets": [
          ["-1", "text"],
          ["-1", "value"],
          ["-1", "value_1"],
          ["-1", "unet_name"],
          ["-1", "clip_name"],
          ["-1", "vae_name"],
          ["73", "noise_seed"],
          ["73", "control_after_generate"]
        ]
      },
      "widgets_values": [
        "",
        1024,
        1024,
        "flux-2-klein-base-9b-fp8.safetensors",
        "qwen_3_8b_fp8mixed.safetensors",
        "flux2-vae.safetensors"
      ]
    }
  ],
  "links": [
    [154, 75, 0, 9, 0, "IMAGE"],
    [165, 80, 0, 81, 0, "STRING"],
    [166, 81, 0, 82, 0, "LIST"],
    [167, 82, 0, 75, 2, "STRING"],
    [168, 84, 0, 9, 1, "STRING"],
    [169, 82, 1, 84, 0, "INT"]
  ],
  "groups": [],
  "definitions": {
    "subgraphs": [
      {
        "id": "7b34ab90-36f9-45ba-a665-71d418f0df18",
        "version": 1,
        "state": {
          "lastGroupId": 4,
          "lastNodeId": 75,
          "lastLinkId": 162,
          "lastRerouteId": 0
        },
        "revision": 0,
        "config": {},
        "name": "Text to Image (Flux.2 Klein 9B)",
        "inputNode": {
          "id": -10,
          "bounding": [-654.6666797319973, 583.833333604156, 120, 160]
        },
        "outputNode": {
          "id": -20,
          "bounding": [1295.3333202680028, 573.833333604156, 120, 60]
        },
        "inputs": [
          {
            "id": "765f2681-7227-4d56-b48b-73a758973d7c",
            "name": "value",
            "type": "INT",
            "linkIds": [155],
            "label": "width",
            "pos": [-554.6666797319973, 603.833333604156]
          },
          {
            "id": "6527c96e-0ca0-4afe-bd2f-149a80412736",
            "name": "value_1",
            "type": "INT",
            "linkIds": [157],
            "label": "height",
            "pos": [-554.6666797319973, 623.833333604156]
          },
          {
            "id": "ae713dbf-52cb-471a-807d-b12fa9acbb48",
            "name": "unet_name",
            "type": "COMBO",
            "linkIds": [159],
            "pos": [-554.6666797319973, 643.833333604156]
          },
          {
            "id": "f29f705e-e43a-4502-b231-a1eea93a1d69",
            "name": "clip_name",
            "type": "COMBO",
            "linkIds": [160],
            "pos": [-554.6666797319973, 663.833333604156]
          },
          {
            "id": "a954f490-386b-4367-9ea1-1b65913963a5",
            "name": "vae_name",
            "type": "COMBO",
            "linkIds": [161],
            "pos": [-554.6666797319973, 683.833333604156]
          },
          {
            "id": "7061147a-fb75-450d-8e97-c8be594a8e16",
            "name": "text",
            "type": "STRING",
            "linkIds": [162],
            "label": "prompt",
            "pos": [-554.6666797319973, 703.833333604156]
          }
        ],
        "outputs": [
          {
            "id": "c5e7966d-07ed-4c9a-ad89-9d378a41ea7b",
            "name": "IMAGE",
            "type": "IMAGE",
            "linkIds": [153],
            "localized_name": "IMAGE",
            "pos": [1315.3333202680028, 593.833333604156]
          }
        ],
        "widgets": [],
        "nodes": [
          {
            "id": 61,
            "type": "KSamplerSelect",
            "pos": [461.3333202680027, 468.83333360415605],
            "size": [270, 58],
            "flags": {},
            "order": 0,
            "mode": 0,
            "inputs": [],
            "outputs": [
              {
                "localized_name": "SAMPLER",
                "name": "SAMPLER",
                "type": "SAMPLER",
                "links": [144]
              }
            ],
            "properties": {"Node name for S&R": "KSamplerSelect"},
            "widgets_values": ["euler"]
          },
          {
            "id": 62,
            "type": "Flux2Scheduler",
            "pos": [461.3333202680027, 568.833333604156],
            "size": [270, 106],
            "flags": {},
            "order": 2,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "width",
                "name": "width",
                "type": "INT",
                "widget": {"name": "width"},
                "link": 137
              },
              {
                "localized_name": "height",
                "name": "height",
                "type": "INT",
                "widget": {"name": "height"},
                "link": 138
              }
            ],
            "outputs": [
              {
                "localized_name": "SIGMAS",
                "name": "SIGMAS",
                "type": "SIGMAS",
                "links": [145]
              }
            ],
            "properties": {"Node name for S&R": "Flux2Scheduler"},
            "widgets_values": [20, 1024, 1024]
          },
          {
            "id": 63,
            "type": "CFGGuider",
            "pos": [461.3333202680027, 328.83333360415605],
            "size": [270, 98],
            "flags": {},
            "order": 3,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "model",
                "name": "model",
                "type": "MODEL",
                "link": 139
              },
              {
                "localized_name": "positive",
                "name": "positive",
                "type": "CONDITIONING",
                "link": 140
              },
              {
                "localized_name": "negative",
                "name": "negative",
                "type": "CONDITIONING",
                "link": 141
              }
            ],
            "outputs": [
              {
                "localized_name": "GUIDER",
                "name": "GUIDER",
                "type": "GUIDER",
                "links": [143]
              }
            ],
            "properties": {"Node name for S&R": "CFGGuider"},
            "widgets_values": [5]
          },
          {
            "id": 64,
            "type": "SamplerCustomAdvanced",
            "pos": [761.3333202680027, 248.83333360415605],
            "size": [212.3638671875, 106],
            "flags": {},
            "order": 4,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "noise",
                "name": "noise",
                "type": "NOISE",
                "link": 142
              },
              {
                "localized_name": "guider",
                "name": "guider",
                "type": "GUIDER",
                "link": 143
              },
              {
                "localized_name": "sampler",
                "name": "sampler",
                "type": "SAMPLER",
                "link": 144
              },
              {
                "localized_name": "sigmas",
                "name": "sigmas",
                "type": "SIGMAS",
                "link": 145
              },
              {
                "localized_name": "latent_image",
                "name": "latent_image",
                "type": "LATENT",
                "link": 146
              }
            ],
            "outputs": [
              {
                "localized_name": "output",
                "name": "output",
                "type": "LATENT",
                "links": [147]
              },
              {
                "localized_name": "denoised_output",
                "name": "denoised_output",
                "type": "LATENT",
                "links": []
              }
            ],
            "properties": {"Node name for S&R": "SamplerCustomAdvanced"},
            "widgets_values": []
          },
          {
            "id": 65,
            "type": "VAEDecode",
            "pos": [1015.3333202680027, 178.83333360415605],
            "size": [220, 46],
            "flags": {},
            "order": 5,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "samples",
                "name": "samples",
                "type": "LATENT",
                "link": 147
              },
              {
                "localized_name": "vae",
                "name": "vae",
                "type": "VAE",
                "link": 148
              }
            ],
            "outputs": [
              {
                "localized_name": "IMAGE",
                "name": "IMAGE",
                "type": "IMAGE",
                "slot_index": 0,
                "links": [153]
              }
            ],
            "properties": {"Node name for S&R": "VAEDecode"},
            "widgets_values": []
          },
          {
            "id": 66,
            "type": "EmptyFlux2LatentImage",
            "pos": [455.3333202680027, 828.833333604156],
            "size": [270, 106],
            "flags": {},
            "order": 6,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "width",
                "name": "width",
                "type": "INT",
                "widget": {"name": "width"},
                "link": 149
              },
              {
                "localized_name": "height",
                "name": "height",
                "type": "INT",
                "widget": {"name": "height"},
                "link": 150
              }
            ],
            "outputs": [
              {
                "localized_name": "LATENT",
                "name": "LATENT",
                "type": "LATENT",
                "links": [146]
              }
            ],
            "properties": {"Node name for S&R": "EmptyFlux2LatentImage"},
            "widgets_values": [1024, 1024, 1]
          },
          {
            "id": 67,
            "type": "CLIPTextEncode",
            "pos": [-34.666679731997306, 558.833333604156],
            "size": [430, 100],
            "flags": {},
            "order": 7,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "clip",
                "name": "clip",
                "type": "CLIP",
                "link": 152
              }
            ],
            "outputs": [
              {
                "localized_name": "CONDITIONING",
                "name": "CONDITIONING",
                "type": "CONDITIONING",
                "slot_index": 0,
                "links": [141]
              }
            ],
            "title": "CLIP Text Encode (Negative Prompt)",
            "properties": {"Node name for S&R": "CLIPTextEncode"},
            "widgets_values": [""],
            "color": "#322",
            "bgcolor": "#533"
          },
          {
            "id": 68,
            "type": "PrimitiveInt",
            "pos": [-414.6666797319973, 808.833333604156],
            "size": [270, 82],
            "flags": {},
            "order": 8,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "value",
                "name": "value",
                "type": "INT",
                "widget": {"name": "value"},
                "link": 155
              }
            ],
            "outputs": [
              {
                "localized_name": "INT",
                "name": "INT",
                "type": "INT",
                "links": [137, 149]
              }
            ],
            "title": "Width",
            "properties": {"Node name for S&R": "PrimitiveInt"},
            "widgets_values": [1024, "fixed"]
          },
          {
            "id": 69,
            "type": "PrimitiveInt",
            "pos": [-414.6666797319973, 958.833333604156],
            "size": [270, 82],
            "flags": {},
            "order": 9,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "value",
                "name": "value",
                "type": "INT",
                "widget": {"name": "value"},
                "link": 157
              }
            ],
            "outputs": [
              {
                "localized_name": "INT",
                "name": "INT",
                "type": "INT",
                "links": [138, 150]
              }
            ],
            "title": "Height",
            "properties": {"Node name for S&R": "PrimitiveInt"},
            "widgets_values": [1024, "fixed"]
          },
          {
            "id": 73,
            "type": "RandomNoise",
            "pos": [461.3333202680027, 208.83333360415605],
            "size": [270, 82],
            "flags": {},
            "order": 1,
            "mode": 0,
            "inputs": [],
            "outputs": [
              {
                "localized_name": "NOISE",
                "name": "NOISE",
                "type": "NOISE",
                "links": [142]
              }
            ],
            "properties": {"Node name for S&R": "RandomNoise"},
            "widgets_values": [390466806913258, "randomize"]
          },
          {
            "id": 70,
            "type": "UNETLoader",
            "pos": [-464.6666797319973, 228.66668403603927],
            "size": [364.42708333333337, 82],
            "flags": {},
            "order": 10,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "unet_name",
                "name": "unet_name",
                "type": "COMBO",
                "widget": {"name": "unet_name"},
                "link": 159
              }
            ],
            "outputs": [
              {
                "localized_name": "MODEL",
                "name": "MODEL",
                "type": "MODEL",
                "links": [139]
              }
            ],
            "properties": {
              "Node name for S&R": "UNETLoader",
              "models": [
                {
                  "name": "flux-2-klein-base-9b-fp8.safetensors",
                  "url": "https://huggingface.co/black-forest-labs/FLUX.2-klein-base-9b-fp8/resolve/main/flux-2-klein-base-9b-fp8.safetensors",
                  "directory": "diffusion_models"
                }
              ]
            },
            "widgets_values": ["flux-2-klein-base-9b-fp8.safetensors", "default"]
          },
          {
            "id": 71,
            "type": "CLIPLoader",
            "pos": [-464.6666797319973, 378.66668403603927],
            "size": [364.42708333333337, 106],
            "flags": {},
            "order": 11,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "clip_name",
                "name": "clip_name",
                "type": "COMBO",
                "widget": {"name": "clip_name"},
                "link": 160
              }
            ],
            "outputs": [
              {
                "localized_name": "CLIP",
                "name": "CLIP",
                "type": "CLIP",
                "links": [151, 152]
              }
            ],
            "properties": {
              "Node name for S&R": "CLIPLoader",
              "models": [
                {
                  "name": "qwen_3_8b_fp8mixed.safetensors",
                  "url": "https://huggingface.co/Comfy-Org/flux2-klein-9B/resolve/main/split_files/text_encoders/qwen_3_8b_fp8mixed.safetensors",
                  "directory": "text_encoders"
                }
              ]
            },
            "widgets_values": ["qwen_3_8b_fp8mixed.safetensors", "flux2", "default"]
          },
          {
            "id": 72,
            "type": "VAELoader",
            "pos": [-464.6666797319973, 548.6666840360392],
            "size": [364.42708333333337, 58],
            "flags": {},
            "order": 12,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "vae_name",
                "name": "vae_name",
                "type": "COMBO",
                "widget": {"name": "vae_name"},
                "link": 161
              }
            ],
            "outputs": [
              {
                "localized_name": "VAE",
                "name": "VAE",
                "type": "VAE",
                "links": [148]
              }
            ],
            "properties": {
              "Node name for S&R": "VAELoader",
              "models": [
                {
                  "name": "flux2-vae.safetensors",
                  "url": "https://huggingface.co/Comfy-Org/flux2-dev/resolve/main/split_files/vae/flux2-vae.safetensors",
                  "directory": "vae"
                }
              ]
            },
            "widgets_values": ["flux2-vae.safetensors"]
          },
          {
            "id": 74,
            "type": "CLIPTextEncode",
            "pos": [-34.666679731997306, 228.83333360415605],
            "size": [430, 280],
            "flags": {},
            "order": 13,
            "mode": 0,
            "inputs": [
              {
                "localized_name": "clip",
                "name": "clip",
                "type": "CLIP",
                "link": 151
              },
              {
                "localized_name": "text",
                "name": "text",
                "type": "STRING",
                "widget": {"name": "text"},
                "link": 162
              }
            ],
            "outputs": [
              {
                "localized_name": "CONDITIONING",
                "name": "CONDITIONING",
                "type": "CONDITIONING",
                "slot_index": 0,
                "links": [140]
              }
            ],
            "title": "CLIP Text Encode (Positive Prompt)",
            "properties": {"Node name for S&R": "CLIPTextEncode"},
            "widgets_values": [""],
            "color": "#232",
            "bgcolor": "#353"
          }
        ],
        "groups": [
          {
            "id": 1,
            "title": "Models",
            "bounding": [-470, 140, 380, 550],
            "color": "#3f789e",
            "font_size": 24,
            "flags": {}
          },
          {
            "id": 2,
            "title": "Prompt",
            "bounding": [-50, 140, 470, 550],
            "color": "#3f789e",
            "font_size": 24,
            "flags": {}
          },
          {
            "id": 3,
            "title": "Sampler",
            "bounding": [460, 140, 532.3638671875, 550],
            "color": "#3f789e",
            "font_size": 24,
            "flags": {}
          },
          {
            "id": 4,
            "title": "Image Size",
            "bounding": [-470, 720, 380, 350],
            "color": "#3f789e",
            "font_size": 24,
            "flags": {}
          }
        ],
        "links": [
          {"id": 137, "origin_id": 68, "origin_slot": 0, "target_id": 62, "target_slot": 0, "type": "INT"},
          {"id": 138, "origin_id": 69, "origin_slot": 0, "target_id": 62, "target_slot": 1, "type": "INT"},
          {"id": 139, "origin_id": 70, "origin_slot": 0, "target_id": 63, "target_slot": 0, "type": "MODEL"},
          {"id": 140, "origin_id": 74, "origin_slot": 0, "target_id": 63, "target_slot": 1, "type": "CONDITIONING"},
          {"id": 141, "origin_id": 67, "origin_slot": 0, "target_id": 63, "target_slot": 2, "type": "CONDITIONING"},
          {"id": 142, "origin_id": 73, "origin_slot": 0, "target_id": 64, "target_slot": 0, "type": "NOISE"},
          {"id": 143, "origin_id": 63, "origin_slot": 0, "target_id": 64, "target_slot": 1, "type": "GUIDER"},
          {"id": 144, "origin_id": 61, "origin_slot": 0, "target_id": 64, "target_slot": 2, "type": "SAMPLER"},
          {"id": 145, "origin_id": 62, "origin_slot": 0, "target_id": 64, "target_slot": 3, "type": "SIGMAS"},
          {"id": 146, "origin_id": 66, "origin_slot": 0, "target_id": 64, "target_slot": 4, "type": "LATENT"},
          {"id": 147, "origin_id": 64, "origin_slot": 0, "target_id": 65, "target_slot": 0, "type": "LATENT"},
          {"id": 148, "origin_id": 72, "origin_slot": 0, "target_id": 65, "target_slot": 1, "type": "VAE"},
          {"id": 149, "origin_id": 68, "origin_slot": 0, "target_id": 66, "target_slot": 0, "type": "INT"},
          {"id": 150, "origin_id": 69, "origin_slot": 0, "target_id": 66, "target_slot": 1, "type": "INT"},
          {"id": 152, "origin_id": 71, "origin_slot": 0, "target_id": 67, "target_slot": 0, "type": "CLIP"},
          {"id": 151, "origin_id": 71, "origin_slot": 0, "target_id": 74, "target_slot": 0, "type": "CLIP"},
          {"id": 153, "origin_id": 65, "origin_slot": 0, "target_id": -20, "target_slot": 0, "type": "IMAGE"},
          {"id": 155, "origin_id": -10, "origin_slot": 0, "target_id": 68, "target_slot": 0, "type": "INT"},
          {"id": 157, "origin_id": -10, "origin_slot": 1, "target_id": 69, "target_slot": 0, "type": "INT"},
          {"id": 159, "origin_id": -10, "origin_slot": 2, "target_id": 70, "target_slot": 0, "type": "COMBO"},
          {"id": 160, "origin_id": -10, "origin_slot": 3, "target_id": 71, "target_slot": 0, "type": "COMBO"},
          {"id": 161, "origin_id": -10, "origin_slot": 4, "target_id": 72, "target_slot": 0, "type": "COMBO"},
          {"id": 162, "origin_id": -10, "origin_slot": 5, "target_id": 74, "target_slot": 1, "type": "STRING"}
        ],
        "extra": {
          "workflowRendererVersion": "LG"
        }
      }
    ]
  },
  "config": {},
  "extra": {
    "ds": {
      "scale": 1.0,
      "offset": [0, 0]
    },
    "frontendVersion": "1.37.11",
    "workflowRendererVersion": "LG"
  },
  "version": 0.4
}
